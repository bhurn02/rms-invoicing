<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Meter Reading - Troubleshooting Guide</title>
    
    <!-- Bootstrap 5.3+ CSS -->
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/css/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/css/custom-theme.css" rel="stylesheet">
    
    <style>
        .troubleshoot-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .issue-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        .issue-header {
            padding: 1rem 1.5rem;
            font-weight: 600;
            color: white;
        }
        .issue-content {
            padding: 1.5rem;
        }
        .severity-critical {
            background: linear-gradient(135deg, #dc2626, #ef4444);
        }
        .severity-high {
            background: linear-gradient(135deg, #ea580c, #f97316);
        }
        .severity-medium {
            background: linear-gradient(135deg, #d97706, #f59e0b);
        }
        .severity-low {
            background: linear-gradient(135deg, #059669, #10b981);
        }
        .solution-step {
            background: #f8fafc;
            border-left: 4px solid #1e40af;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 0 8px 8px 0;
        }
        .warning-note {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .success-note {
            background: #d1fae5;
            border: 1px solid #10b981;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .code-example {
            background: #1f2937;
            color: #f9fafb;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
        }
        
        /* Smart Navigation Styles */
        .help-nav {
            position: sticky;
            top: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1.5rem;
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin-bottom: 4px;
            padding: 12px 16px;
        }

        .nav-link:hover {
            background-color: #f8f9fa;
            transform: translateX(4px);
        }

        .nav-link.active {
            background-color: #1e40af;
            color: white;
            box-shadow: 0 2px 8px rgba(30, 64, 175, 0.3);
        }

        .nav-link.active::before {
            content: '';
            position: absolute;
            left: -16px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 24px;
            background-color: #1e40af;
            border-radius: 2px;
        }

        .nav-link i {
            margin-right: 8px;
            width: 16px;
            text-align: center;
        }

        /* Progress Indicator */
        .nav-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #e5e7eb;
            z-index: 1000;
        }

        .nav-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #1e40af, #3b82f6);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Mobile Navigation Toggle */
        .mobile-nav-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1050;
            background: #1e40af;
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .mobile-nav-toggle:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 64, 175, 0.4);
        }
        
        /* Mobile-First Responsive Design */
        @media (max-width: 991.98px) {
            .troubleshoot-container {
                padding: 0 1rem;
                padding-top: 90px;
            }
            
            .mobile-nav-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .help-nav {
                position: fixed;
                top: 0;
                left: -100%;
                width: 320px;
                height: 100vh;
                background: white;
                z-index: 1040;
                transition: left 0.3s ease;
                overflow-y: auto;
                box-shadow: 2px 0 20px rgba(0,0,0,0.1);
                border-radius: 0;
                padding: 0;
            }
            
            .help-nav.show {
                left: 0;
            }
            
            .help-nav h5 {
                font-size: 1.25rem;
                margin: 0;
                padding: 2rem 1.5rem 1.5rem 1.5rem;
                text-align: center;
                color: #1e40af;
                font-weight: 600;
                border-bottom: 2px solid #e5e7eb;
                background: white;
                position: sticky;
                top: 0;
                z-index: 1;
            }
            
            .help-nav nav {
                padding: 0 1.5rem 2rem 1.5rem;
            }
            
            .nav-link {
                padding: 16px 20px;
                font-size: 1rem;
                font-weight: 500;
                border-radius: 12px;
                margin-bottom: 8px;
                min-height: 48px;
                display: flex;
                align-items: center;
                transition: all 0.3s ease;
                background: #f8fafc;
                border: 2px solid transparent;
                color: #374151;
                text-decoration: none;
            }
            
            .nav-link:hover {
                background: #e0f2fe;
                border-color: #1e40af;
                transform: translateX(8px);
                box-shadow: 0 4px 12px rgba(30, 64, 175, 0.15);
                color: #1e40af;
            }
            
            .nav-link.active {
                background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
                color: white;
                border-color: #1e40af;
                box-shadow: 0 6px 20px rgba(30, 64, 175, 0.3);
                transform: translateX(8px);
            }
            
            .nav-link.active::before {
                display: none;
            }
            
            .nav-link i {
                margin-right: 12px;
                width: 20px;
                font-size: 1.1rem;
                text-align: center;
            }
            
            .badge {
                font-size: 0.75rem;
                padding: 4px 8px;
                border-radius: 6px;
                font-weight: 600;
            }
            
            .issue-card {
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            }
            
            /* Mobile button optimization */
            .help-nav .btn {
                font-size: 0.9rem;
                padding: 8px 16px;
                border-radius: 8px;
                font-weight: 500;
                min-height: 40px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
            }
            
            /* Mobile overlay */
            .mobile-nav-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1035;
                transition: opacity 0.3s ease;
            }
            
            .mobile-nav-overlay.show {
                display: block;
                animation: fadeIn 0.3s ease;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
        }
        
        /* Mobile Optimization */
        @media (max-width: 768px) {
            .nav-link {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            
            .nav-link.active::before {
                left: -12px;
                width: 3px;
                height: 20px;
            }
        }
    </style>
</head>
<body class="bg-light">
    <!-- Mobile Navigation Toggle -->
    <button class="mobile-nav-toggle" id="mobileNavToggle">
        â˜°
    </button>
    
    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>
    
    <div class="container-fluid py-4">
        <div class="troubleshoot-container">
            <div class="row">
                <!-- Navigation Sidebar -->
                <div class="col-lg-3">
                    <div class="help-nav">
                        <h5 class="mb-3">
                            <i class="bi bi-tools me-2"></i>Troubleshooting
                        </h5>
                        <nav class="nav nav-pills flex-column" id="troubleshootNavigation">
                            <a class="nav-link" href="#camera-issues" data-section="camera-issues">
                                <i class="bi bi-camera-video"></i>Camera Issues
                            </a>
                            <a class="nav-link" href="#scanning-issues" data-section="scanning-issues">
                                <i class="bi bi-qr-code-scan"></i>Scanning Issues
                            </a>
                            <a class="nav-link" href="#form-issues" data-section="form-issues">
                                <i class="bi bi-file-text"></i>Form Issues
                            </a>
                            <a class="nav-link" href="#duplicate-issues" data-section="duplicate-issues">
                                <i class="bi bi-shield-check"></i>Duplicate Detection
                            </a>
                            <a class="nav-link" href="#offline-issues" data-section="offline-issues">
                                <i class="bi bi-list-check"></i>Offline Display
                            </a>
                            <a class="nav-link" href="#sync-issues" data-section="sync-issues">
                                <i class="bi bi-arrow-repeat"></i>Sync Issues
                            </a>
                            <a class="nav-link" href="#network-issues" data-section="network-issues">
                                <i class="bi bi-wifi-off"></i>Network Issues
                            </a>
                            <a class="nav-link" href="#access-issues" data-section="access-issues">
                                <i class="bi bi-person-x"></i>Access Issues
                            </a>
                            <a class="nav-link" href="#error-messages" data-section="error-messages">
                                <i class="bi bi-exclamation-triangle"></i>Error Messages
                            </a>
                            <a class="nav-link" href="#prevention" data-section="prevention">
                                <i class="bi bi-shield-check"></i>Prevention Tips
                            </a>
                        </nav>
                        
                        <hr class="my-4">
                        
                        <div class="text-center">
                            <a href="../index.php" class="btn btn-outline-primary">
                                <i class="bi bi-arrow-left me-2"></i>Back to Scanner
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div class="col-lg-9">
                    <!-- Header -->
                    <div class="text-center mb-4">
                        <h1 class="display-5 fw-bold text-primary mb-2">
                            <i class="bi bi-tools me-3"></i>Troubleshooting Guide
                        </h1>
                        <p class="lead text-muted">Solutions for Common QR Meter Reading Issues</p>
                        <div class="badge bg-warning fs-6">Technical Support Reference</div>
                    </div>
            
            <!-- Camera Issues -->
            <section id="camera-issues">
            <div class="issue-card">
                <div class="issue-header severity-high">
                    <h4 class="mb-0">
                        <i class="bi bi-camera-video me-2"></i>Camera Not Working
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> Camera doesn't start or shows black screen when trying to scan QR codes.</p>
                    
                    <h6 class="mt-4 mb-3">Solutions (try in order):</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-1-circle-fill me-2 text-primary"></i>Check Browser Permissions
                        </h6>
                        <p class="mb-0">Ensure your browser has permission to access the camera. Look for a camera icon in the address bar and click "Allow" if prompted.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-2-circle-fill me-2 text-primary"></i>Close Other Applications
                        </h6>
                        <p class="mb-0">Close any other applications that might be using the camera (video calls, other camera apps, etc.).</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-3-circle-fill me-2 text-primary"></i>Refresh the Page
                        </h6>
                        <p class="mb-0">Refresh the browser page and try starting the scanner again.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-4-circle-fill me-2 text-primary"></i>Check Camera Hardware
                        </h6>
                        <p class="mb-0">Test the camera with another application to ensure it's working properly.</p>
                    </div>
                    
                    <div class="warning-note">
                        <h6 class="mb-2">
                            <i class="bi bi-exclamation-triangle me-2"></i>Still Not Working?
                        </h6>
                        <p class="mb-0">Try using a different browser or contact IT support for device-specific issues.</p>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Scanning Issues -->
            <section id="scanning-issues">
            <div class="issue-card">
                <div class="issue-header severity-medium">
                    <h4 class="mb-0">
                        <i class="bi bi-qr-code-scan me-2"></i>QR Code Not Scanning
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> Camera is working but QR codes are not being detected or processed.</p>
                    
                    <h6 class="mt-4 mb-3">Solutions:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-sun me-2 text-warning"></i>Improve Lighting
                        </h6>
                        <p class="mb-0">Ensure adequate lighting on the QR code. Avoid shadows and glare. Use a flashlight if necessary.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-hand-index me-2 text-primary"></i>Hold Device Steady
                        </h6>
                        <p class="mb-0">Hold your device steady and at the right distance (6-12 inches from the QR code).</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-arrow-repeat me-2 text-success"></i>Try Different Angles
                        </h6>
                        <p class="mb-0">Move your device to different angles - sometimes QR codes scan better from the side or slightly above.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-brush me-2 text-info"></i>Clean the QR Code
                        </h6>
                        <p class="mb-0">Clean the QR code if it's dirty, dusty, or damaged. Use a soft cloth to remove debris.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-zoom-in me-2 text-secondary"></i>Adjust Distance
                        </h6>
                        <p class="mb-0">Move closer or farther away from the QR code. The optimal distance varies by device and QR code size.</p>
                    </div>
                    
                    <div class="warning-note">
                        <h6 class="mb-2">
                            <i class="bi bi-exclamation-triangle me-2"></i>QR Code Quality Issues
                        </h6>
                        <p class="mb-0">If the QR code is damaged, faded, or poorly printed, contact your administrator to generate a new one.</p>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Form Issues -->
            <section id="form-issues">
            <div class="issue-card">
                <div class="issue-header severity-medium">
                    <h4 class="mb-0">
                        <i class="bi bi-file-text me-2"></i>Form Not Auto-Populating
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> QR code scans successfully but the form doesn't populate with tenant information.</p>
                    
                    <h6 class="mt-4 mb-3">Possible Causes & Solutions:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-qr-code me-2 text-primary"></i>Invalid QR Code Format
                        </h6>
                        <p class="mb-0">Check if the QR code contains the correct format: <code>PropertyCode|UnitNumber|MeterID</code></p>
                        <div class="code-example">
                            Correct Format: GCA|101|M001
                            Incorrect Format: GCA-101-M001 or GCA 101 M001
                        </div>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-person-x me-2 text-warning"></i>No Active Tenant
                        </h6>
                        <p class="mb-0">The property/unit combination doesn't have an active tenant assigned. Contact your administrator to verify tenant assignment.</p>
                    </div>
                    
                    <div class="solution-step">
                            <i class="bi bi-database me-2 text-info"></i>Database Connection Issue
                        </h6>
                        <p class="mb-0">Check your internet connection. The system needs to connect to the database to retrieve tenant information.</p>
                    </div>
                    
                    <div class="success-note">
                        <h6 class="mb-2">
                            <i class="bi bi-lightbulb me-2"></i>Manual Entry Option
                        </h6>
                        <p class="mb-0">If auto-population fails, you can manually enter the Property ID and Unit Number, then proceed with the meter reading.</p>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Duplicate Issues -->
            <section id="duplicate-issues">
            <div class="issue-card">
                <div class="issue-header severity-low">
                    <h4 class="mb-0">
                        <i class="bi bi-shield-check me-2"></i>"Already Scanned" Notification
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Scenario:</strong> After scanning a QR code, you see "Already Scanned" notification and the form doesn't appear.</p>
                    
                    <div class="success-note">
                        <h6 class="mb-2">
                            <i class="bi bi-check-circle me-2"></i>This is Normal Behavior
                        </h6>
                        <p class="mb-0">The duplicate prevention feature is working correctly! The system detected that this property/unit was already read in the current reading period.</p>
                    </div>
                    
                    <h6 class="mt-4 mb-3">What This Means:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-calendar-check me-2 text-primary"></i>Same Period Detection
                        </h6>
                        <p class="mb-0">The system checks if the same property and unit combination was read in the current reading period (typically current month). This prevents accidental duplicate readings.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-info-circle me-2 text-info"></i>Check the Details
                        </h6>
                        <p class="mb-0">The notification shows when the reading was previously recorded and what value was entered. Verify this matches your expectations.</p>
                    </div>
                    
                    <h6 class="mt-4 mb-3">What to Do:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-1-circle-fill me-2 text-success"></i>Verify the Date
                        </h6>
                        <p class="mb-0">Check the date shown in the notification. If it's from the current reading period, proceed to the next meter.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-2-circle-fill me-2 text-success"></i>Check Recent Readings Table
                        </h6>
                        <p class="mb-0">Scroll down to the Recent QR Readings table to see the previous reading details including tenant name and reading value.</p>
                    </div>
                    
                    <div class="warning-note">
                        <h6 class="mb-2">
                            <i class="bi bi-exclamation-triangle me-2"></i>If Reading Seems Wrong
                        </h6>
                        <p class="mb-0">If you believe the duplicate notification is incorrect (wrong property/unit or wrong period), contact your administrator. Do not attempt to bypass the duplicate prevention system.</p>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Offline Issues -->
            <section id="offline-issues">
            <div class="issue-card">
                <div class="issue-header severity-low">
                    <h4 class="mb-0">
                        <i class="bi bi-list-check me-2"></i>Offline Readings Not Showing in Table
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> You saved a reading while offline but don't see it in the Recent QR Readings table.</p>
                    
                    <h6 class="mt-4 mb-3">Solutions:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-arrow-clockwise me-2 text-primary"></i>Refresh the Page
                        </h6>
                        <p class="mb-0">Try refreshing the browser page (F5 or pull-to-refresh on mobile). Offline readings should appear with "Saved Offline" orange badge.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-journal-check me-2 text-info"></i>Check Browser Console
                        </h6>
                        <p class="mb-0">For technical users: Open browser console (F12) and check for any JavaScript errors related to localStorage or data loading.</p>
                    </div>
                    
                    <div class="success-note">
                        <h6 class="mb-2">
                            <i class="bi bi-check-circle me-2"></i>Data is Still Safe
                        </h6>
                        <p class="mb-0">Even if the reading doesn't appear in the table immediately, it's safely stored in your browser's local storage and will sync when connection is restored.</p>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Sync Issues -->
            <section id="sync-issues">
            <div class="issue-card">
                <div class="issue-header severity-medium">
                    <h4 class="mb-0">
                        <i class="bi bi-arrow-repeat me-2"></i>Table Not Updating After Sync
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> After syncing offline readings, the Recent QR Readings table still shows "Saved Offline" badges or doesn't update.</p>
                    
                    <h6 class="mt-4 mb-3">Solutions:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-arrow-clockwise me-2 text-primary"></i>Manual Refresh
                        </h6>
                        <p class="mb-0">Refresh the browser page to reload the Recent QR Readings table with the latest synced data.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-clock-history me-2 text-warning"></i>Wait for Sync Completion
                        </h6>
                        <p class="mb-0">Ensure the sync process has fully completed. Look for the sync progress indicator to disappear and the avatar dot to turn green (all synced) before expecting table updates.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-wifi me-2 text-success"></i>Verify Connection
                        </h6>
                        <p class="mb-0">Check that you have a stable internet connection. The table auto-refresh only happens after successful sync completion.</p>
                    </div>
                </div>
            </div>
            </section>
            
            <!-- Network Issues -->
            <section id="network-issues">
            <div class="issue-card">
                <div class="issue-header severity-low">
                    <h4 class="mb-0">
                        <i class="bi bi-wifi-off me-2"></i>Network Connection Issues
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> No internet connection or slow network affecting the system.</p>
                    
                    <div class="success-note">
                        <h6 class="mb-2">
                            <i class="bi bi-check-circle me-2"></i>Offline Mode Available
                        </h6>
                        <p class="mb-0">The system works offline! Your readings will be saved locally and automatically synced when the connection is restored.</p>
                    </div>
                    
                    <h6 class="mt-4 mb-3">What Happens Offline:</h6>
                    <ul>
                        <li>Readings are saved to your device</li>
                        <li>Red dot appears on your user avatar</li>
                        <li>Offline indicator shows in navigation</li>
                        <li>Data syncs automatically when online</li>
                        <li>No data loss - everything is preserved</li>
                    </ul>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-wifi me-2 text-success"></i>Check Connection
                        </h6>
                        <p class="mb-0">Verify your device's internet connection. Try accessing other websites to confirm connectivity.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-arrow-clockwise me-2 text-primary"></i>Manual Sync
                        </h6>
                        <p class="mb-0">If you have pending offline readings, look for the sync button in the navigation bar to manually trigger synchronization.</p>
                    </div>
                </div>
            </div>
            
            <!-- Sync Failing Issue -->
            <div class="issue-card">
                <div class="issue-header severity-medium">
                    <h4 class="mb-0">
                        <i class="bi bi-arrow-clockwise me-2"></i>Sync Failing Repeatedly
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> Offline readings not syncing or sync failing repeatedly.</p>
                    
                    <h6 class="mt-4 mb-3">Status Indicators:</h6>
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <div class="badge bg-success fs-6 p-2 mb-2">Green Dot</div>
                            <p class="small">Online & Synced</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="badge bg-danger fs-6 p-2 mb-2">Red Dot</div>
                            <p class="small">Offline</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="badge bg-warning fs-6 p-2 mb-2">Orange Dot</div>
                            <p class="small">Pending Sync</p>
                        </div>
                    </div>
                    
                    <h6 class="mt-4 mb-3">Solutions:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-wifi me-2 text-success"></i>Check Connection Stability
                        </h6>
                        <p class="mb-0">Ensure you have a stable internet connection. The system checks connection stability before auto-sync to prevent data loss.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-arrow-clockwise me-2 text-primary"></i>Manual Sync
                        </h6>
                        <p class="mb-0">Click the sync button in the navigation bar to manually trigger synchronization of pending readings.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-hourglass-split me-2 text-warning"></i>Wait for Auto-Sync
                        </h6>
                        <p class="mb-0">The system automatically retries sync when connection becomes stable. You'll see progress indicators during sync.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-exclamation-triangle me-2 text-danger"></i>Sync Failed
                        </h6>
                        <p class="mb-0">If sync fails, your readings remain safely stored offline. The system will retry automatically or you can use manual sync.</p>
                    </div>
                    
                    <div class="warning-note">
                        <h6 class="mb-2">
                            <i class="bi bi-info-circle me-2"></i>Smart Sync Features
                        </h6>
                        <ul class="mb-0">
                            <li>Connection stability check prevents data loss</li>
                            <li>Duplicate prevention with unique IDs</li>
                            <li>Progress indicators show sync status</li>
                            <li>Failed readings stay in queue for retry</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Access Issues -->
            <section id="access-issues">
            <div class="issue-card">
                <div class="issue-header severity-critical">
                    <h4 class="mb-0">
                        <i class="bi bi-person-x me-2"></i>Access Denied
                    </h4>
                </div>
                <div class="issue-content">
                    <p><strong>Problem:</strong> Cannot access the QR Meter Reading System or specific features.</p>
                    
                    <h6 class="mt-4 mb-3">Common Scenarios:</h6>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-person-check me-2 text-primary"></i>Login Issues
                        </h6>
                        <p class="mb-0">Verify your username and password. Check for typos and ensure Caps Lock is not enabled.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-shield-x me-2 text-warning"></i>Permission Issues
                        </h6>
                        <p class="mb-0">Your account may not have QR Meter Reading permissions. Contact your system administrator to request access.</p>
                    </div>
                    
                    <div class="solution-step">
                        <h6 class="mb-2">
                            <i class="bi bi-clock me-2 text-info"></i>Session Expired
                        </h6>
                        <p class="mb-0">Your session may have expired. Try logging out and logging back in.</p>
                    </div>
                    
                    <div class="warning-note">
                        <h6 class="mb-2">
                            <i class="bi bi-exclamation-triangle me-2"></i>Contact Administrator
                        </h6>
                        <p class="mb-0">If you continue to have access issues, contact your system administrator with your username and the specific error message.</p>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Error Messages -->
            <section id="error-messages">
            <div class="issue-card">
                <div class="issue-header severity-medium">
                    <h4 class="mb-0">
                        <i class="bi bi-exclamation-triangle me-2"></i>Common Error Messages
                    </h4>
                </div>
                <div class="issue-content">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-danger">"No Active Tenant Found"</h6>
                            <p class="small">The property/unit doesn't have an active tenant assigned.</p>
                            <p class="small"><strong>Solution:</strong> Contact administrator to verify tenant assignment.</p>
                            
                            <h6 class="text-warning mt-3">"Invalid QR Code Format"</h6>
                            <p class="small">The QR code doesn't contain the expected data format.</p>
                            <p class="small"><strong>Solution:</strong> Generate a new QR code using the QR Generator.</p>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-warning">"Network Error"</h6>
                            <p class="small">Connection to server is lost or unstable.</p>
                            <p class="small"><strong>Solution:</strong> Check internet connection, data will sync when restored.</p>
                            
                            <h6 class="text-info mt-3">"Camera Permission Denied"</h6>
                            <p class="small">Browser doesn't have permission to access camera.</p>
                            <p class="small"><strong>Solution:</strong> Allow camera access in browser settings.</p>
                            
                            <h6 class="text-warning mt-3">"Sync Failed"</h6>
                            <p class="small">Offline readings couldn't be uploaded to server.</p>
                            <p class="small"><strong>Solution:</strong> Check connection stability, use manual sync button.</p>
                            
                            <h6 class="text-info mt-3">"Connection Lost Notification"</h6>
                            <p class="small">Red notification appears when internet connection is lost.</p>
                            <p class="small"><strong>Solution:</strong> This is normal - continue working, data is saved offline.</p>
                            
                            <h6 class="text-success mt-3">"Connection Restored Notification"</h6>
                            <p class="small">Green notification appears when internet connection returns.</p>
                            <p class="small"><strong>Solution:</strong> This is normal - sync will start automatically.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            </section>
            
            <!-- Prevention -->
            <section id="prevention">
            <div class="issue-card">
                <div class="issue-header severity-low">
                    <h4 class="mb-0">
                        <i class="bi bi-shield-check me-2"></i>Prevention Tips
                    </h4>
                </div>
                <div class="issue-content">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Before Starting Work</h6>
                            <ul class="small">
                                <li>Test camera and scanner functionality</li>
                                <li>Check internet connection</li>
                                <li>Ensure device is charged</li>
                                <li>Verify login credentials</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-success">During Work</h6>
                            <ul class="small">
                                <li>Keep device steady when scanning</li>
                                <li>Ensure good lighting conditions</li>
                                <li>Clean QR codes before scanning</li>
                                <li>Double-check meter readings</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            </section>
            
                    <!-- Footer Navigation -->
                    <footer class="mt-5 pt-4 border-top">
                <div class="text-center mb-4">
                    <p class="text-muted mb-3">
                        <i class="bi bi-compass me-2"></i>Navigate Help Documentation
                    </p>
                    <div class="d-flex flex-wrap justify-content-center gap-2">
                        <a href="help-center.html" class="btn btn-outline-primary">
                            <i class="bi bi-house-door me-2"></i>Help Center
                        </a>
                        <a href="index.html" class="btn btn-outline-primary">
                            <i class="bi bi-book me-2"></i>User Manual
                        </a>
                        <a href="quick-reference.html" class="btn btn-outline-success">
                            <i class="bi bi-lightning-charge me-2"></i>Quick Reference
                        </a>
                        <a href="../index.php" class="btn btn-primary">
                            <i class="bi bi-qr-code-scan me-2"></i>Back to Scanner
                        </a>
                    </div>
                </div>
                
                <div class="text-center pt-3 border-top">
                    <p class="text-muted mb-2">
                        <i class="bi bi-shield-check me-2"></i>
                        QR Meter Reading System v1.2 - Troubleshooting Guide
                    </p>
                    <p class="small text-muted mb-0">
                        For technical support, contact your system administrator.
                    </p>
                </div>
            </footer>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    
    <!-- Smart Navigation Script -->
    <script>
        // Smart Navigation with Active Section Highlighting
        class SmartNavigation {
            constructor() {
                this.navLinks = document.querySelectorAll('#troubleshootNavigation .nav-link');
                this.sections = document.querySelectorAll('[id]');
                this.currentActive = null;
                this.init();
            }

            init() {
                this.createProgressBar();
                this.setupEventListeners();
                this.updateActiveSection();
            }

            createProgressBar() {
                const progressBar = document.createElement('div');
                progressBar.className = 'nav-progress';
                progressBar.innerHTML = '<div class="nav-progress-bar"></div>';
                document.body.appendChild(progressBar);
                this.progressBar = progressBar.querySelector('.nav-progress-bar');
            }

            setupEventListeners() {
                // Smooth scrolling for navigation links
                this.navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetId = link.getAttribute('href').substring(1);
                        this.scrollToSection(targetId);
                    });
                });

                // Scroll event for active section detection
                window.addEventListener('scroll', this.throttle(() => {
                    this.updateActiveSection();
                    this.updateProgressBar();
                }, 100));

                // Resize event for mobile optimization
                window.addEventListener('resize', this.debounce(() => {
                    this.updateActiveSection();
                }, 250));
            }

            scrollToSection(sectionId) {
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    const offsetTop = targetSection.offsetTop - 100;
                    
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                    
                    this.setActiveLink(sectionId);
                }
            }

            updateActiveSection() {
                const scrollPosition = window.scrollY + 150;
                let currentSection = null;

                this.sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;
                    const sectionId = section.getAttribute('id');

                    if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                        currentSection = sectionId;
                    }
                });

                if (!currentSection && scrollPosition > 0) {
                    const lastSection = this.sections[this.sections.length - 1];
                    if (lastSection && scrollPosition > lastSection.offsetTop + lastSection.offsetHeight - 200) {
                        currentSection = lastSection.getAttribute('id');
                    }
                }

                if (currentSection && currentSection !== this.currentActive) {
                    this.setActiveLink(currentSection);
                    this.currentActive = currentSection;
                }
            }

            setActiveLink(sectionId) {
                this.navLinks.forEach(link => {
                    link.classList.remove('active');
                });

                const activeLink = document.querySelector(`#troubleshootNavigation .nav-link[href="#${sectionId}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                    this.ensureLinkVisible(activeLink);
                }
            }

            ensureLinkVisible(activeLink) {
                const navContainer = document.getElementById('troubleshootNavigation');
                const containerRect = navContainer.getBoundingClientRect();
                const linkRect = activeLink.getBoundingClientRect();

                if (window.innerWidth <= 768) {
                    if (linkRect.top < containerRect.top || linkRect.bottom > containerRect.bottom) {
                        activeLink.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center',
                            inline: 'nearest'
                        });
                    }
                }
            }

            updateProgressBar() {
                const windowHeight = window.innerHeight;
                const documentHeight = document.documentElement.scrollHeight;
                const scrollTop = window.scrollY;
                const scrollPercent = (scrollTop / (documentHeight - windowHeight)) * 100;
                
                this.progressBar.style.width = `${Math.min(scrollPercent, 100)}%`;
            }

            throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        }

        // Mobile Navigation Toggle
        class MobileNavigation {
            constructor() {
                this.toggle = document.getElementById('mobileNavToggle');
                this.nav = document.querySelector('.help-nav');
                this.overlay = document.getElementById('mobileNavOverlay');
                this.isOpen = false;
                this.init();
            }

            init() {
                this.setupEventListeners();
            }

            setupEventListeners() {
                this.toggle.addEventListener('click', () => this.toggleNav());
                this.overlay.addEventListener('click', () => this.closeNav());
                
                // Close nav when clicking on nav links
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', () => this.closeNav());
                });
                
                // Close nav on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.isOpen) {
                        this.closeNav();
                    }
                });
            }

            toggleNav() {
                if (this.isOpen) {
                    this.closeNav();
                } else {
                    this.openNav();
                }
            }

            openNav() {
                this.nav.classList.add('show');
                this.overlay.classList.add('show');
                this.toggle.innerHTML = 'âœ•';
                this.isOpen = true;
                document.body.style.overflow = 'hidden';
            }

            closeNav() {
                this.nav.classList.remove('show');
                this.overlay.classList.remove('show');
                this.toggle.innerHTML = 'â˜°';
                this.isOpen = false;
                document.body.style.overflow = '';
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new SmartNavigation();
            new MobileNavigation();
        });
    </script>
</body>
</html>
